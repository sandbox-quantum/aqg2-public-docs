
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<link href="https://docs.aqtiveguard.com/data-sources/aws/" rel="canonical"/>
<link href="../aqg-network-analyzer/reference/" rel="prev"/>
<link href="../aws-kms/" rel="next"/>
<link href="../../images/icons/favicon.ico" rel="icon"/>
<meta content="mkdocs-1.6.0, mkdocs-material-9.5.27" name="generator"/>
<title>AWS - AQtive Guard User Guide</title>
<link href="../../assets/stylesheets/main.6543a935.min.css" rel="stylesheet"/>
<link href="../../assets/stylesheets/palette.06af60db.min.css" rel="stylesheet"/>
<link href="../../gen/style.css" rel="stylesheet"/>
<link href="../../__static__/css/style.css" rel="stylesheet"/>
<link href="../../stylesheets/custom-admonition.css" rel="stylesheet"/>
<script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
<meta flags="EnableAwsV2" flagvalues="" name="flags" redirectto="../..">
<link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../../assets/javascripts/glightbox.min.js"></script></link></meta></head>
<body data-md-color-accent="indigo" data-md-color-primary="black" data-md-color-scheme="default" dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#amazon-web-services-aws">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<div id="saq-ff-overlay"></div>
<header class="md-header md-header--shadow" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="AQtive Guard User Guide" class="md-header__button md-logo" data-md-component="logo" href="../.." title="AQtive Guard User Guide">
<img alt="logo" src="../../images/aqtiveguard-white.svg"/>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
</span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
<ff flags="EnableAwsV2"></ff>AWS
            
          </span>
</div>
</div>
</div>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg>
</label>
<nav aria-label="Search" class="md-search__options">
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" title="Clear" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"></path></svg>
</button>
</nav>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="" tabindex="0">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list" role="presentation"></ol>
</div>
</div>
</div>
</div>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="AQtive Guard User Guide" class="md-nav__button md-logo" data-md-component="logo" href="../.." title="AQtive Guard User Guide">
<img alt="logo" src="../../images/aqtiveguard-white.svg"/>
</a>
    AQtive Guard User Guide
  </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../..">
<span class="md-ellipsis">
    Welcome
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../getting-started/">
<span class="md-ellipsis">
    Getting started
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../login-and-user-roles/">
<span class="md-ellipsis">
    Login &amp; user roles
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../navigation/">
<span class="md-ellipsis">
    Navigation
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../ask-ai/">
<span class="md-ellipsis">
    Ask AI
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_6" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../../filters-and-data-enrichment/">
<span class="md-ellipsis">
    Filters and data enrichment
  </span>
</a>
<label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_6_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_6">
<span class="md-nav__icon md-icon"></span>
            Filters and data enrichment
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../filters-and-data-enrichment/filters/">
<span class="md-ellipsis">
    Filters
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../filters-and-data-enrichment/enrichments/">
<span class="md-ellipsis">
    Enrichments
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../dashboard/">
<span class="md-ellipsis">
    Dashboards
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_8" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../../inventory/">
<span class="md-ellipsis">
    Inventory
  </span>
</a>
<label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_8_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_8">
<span class="md-nav__icon md-icon"></span>
            Inventory
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../inventory/exclusions/">
<span class="md-ellipsis">
    Exclusions
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../impact-assessment/">
<span class="md-ellipsis">
    Impact Assessment
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_10" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../../aqg-aispm/">
<span class="md-ellipsis">
    AI-SPM
  </span>
</a>
<label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_10_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_10">
<span class="md-nav__icon md-icon"></span>
            AI-SPM
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../aqg-aispm/aispm-inventory/">
<span class="md-ellipsis">
    AI-SPM inventory
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../aqg-aispm/managing-ai-issues/">
<span class="md-ellipsis">
    Managing AI issues
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../aqg-aispm/managing-aispm-rules/">
<span class="md-ellipsis">
    Managing AI-SPM rules
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../aqg-aispm/glossary/">
<span class="md-ellipsis">
    AI-SPM glossary
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_11" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../../aqg-protect/">
<span class="md-ellipsis">
    Protect
  </span>
</a>
<label class="md-nav__link" for="__nav_11" id="__nav_11_label" tabindex="0">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_11_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_11">
<span class="md-nav__icon md-icon"></span>
            Protect
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../aqg-protect/navigation/">
<span class="md-ellipsis">
    Navigation
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../aqg-protect/getting-started/">
<span class="md-ellipsis">
    Getting started
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../aqg-protect/deployment-orchestration/">
<span class="md-ellipsis">
    Deployment orchestration
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_12" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../../profiles/">
<span class="md-ellipsis">
    Profiles
  </span>
</a>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_12_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_12">
<span class="md-nav__icon md-icon"></span>
            Profiles
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_13" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../../rules/">
<span class="md-ellipsis">
    Rules
  </span>
</a>
<label class="md-nav__link" for="__nav_13" id="__nav_13_label" tabindex="0">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_13_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_13">
<span class="md-nav__icon md-icon"></span>
            Rules
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../rules/rule-severity/">
<span class="md-ellipsis">
    Rule severity
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_14" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../../issues/">
<span class="md-ellipsis">
    Issues
  </span>
</a>
<label class="md-nav__link" for="__nav_14" id="__nav_14_label" tabindex="0">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_14_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_14">
<span class="md-nav__icon md-icon"></span>
            Issues
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../issues/knowledge-base/">
<span class="md-ellipsis">
    Knowledge base
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../security-knowledge-graph/">
<span class="md-ellipsis">
    Security Knowledge Graph
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../exports/">
<span class="md-ellipsis">
    Exports
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../settings/">
<span class="md-ellipsis">
    Settings
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_18" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../">
<span class="md-ellipsis">
    Data sources
  </span>
</a>
<label class="md-nav__link" for="__nav_18" id="__nav_18_label" tabindex="0">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="true" aria-labelledby="__nav_18_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_18">
<span class="md-nav__icon md-icon"></span>
            Data sources
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../tags/">
<span class="md-ellipsis">
<ff flags="EnableInventoryTagsDisplay"></ff>Tags
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../aqg-file-inspector/">
<span class="md-ellipsis">
    AQG File Inspector
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_18_4" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../aqg-filesystem-scanner/">
<span class="md-ellipsis">
    AQG Filesystem Scanner
  </span>
</a>
<label class="md-nav__link" for="__nav_18_4" id="__nav_18_4_label" tabindex="0">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_18_4_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_18_4">
<span class="md-nav__icon md-icon"></span>
            AQG Filesystem Scanner
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../aqg-filesystem-scanner/windows-getting-started-guide/">
<span class="md-ellipsis">
    Windows getting started guide
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../aqg-filesystem-scanner/linux-getting-started-guide/">
<span class="md-ellipsis">
    Linux getting started guide
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../aqg-filesystem-scanner/supported-formats/">
<span class="md-ellipsis">
    Supported formats
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../aqg-filesystem-scanner/reference/">
<span class="md-ellipsis">
    Reference
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_18_5" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../aqg-java-tracer/">
<span class="md-ellipsis">
    AQG Java Tracer
  </span>
</a>
<label class="md-nav__link" for="__nav_18_5" id="__nav_18_5_label" tabindex="0">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_18_5_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_18_5">
<span class="md-nav__icon md-icon"></span>
            AQG Java Tracer
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../aqg-java-tracer/getting-started/">
<span class="md-ellipsis">
    Getting started
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../aqg-java-tracer/reference/">
<span class="md-ellipsis">
    Reference
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_18_6" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../aqg-network-analyzer/">
<span class="md-ellipsis">
    AQG Network Analyzer
  </span>
</a>
<label class="md-nav__link" for="__nav_18_6" id="__nav_18_6_label" tabindex="0">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_18_6_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_18_6">
<span class="md-nav__icon md-icon"></span>
            AQG Network Analyzer
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../aqg-network-analyzer/getting-started-with-pcap-upload/">
<span class="md-ellipsis">
    Getting started with PCAP Upload
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../aqg-network-analyzer/getting-started-with-live-network-traffic-monitoring/">
<span class="md-ellipsis">
    Getting started with Live Network Traffic Monitoring
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../aqg-network-analyzer/memory/">
<span class="md-ellipsis">
    Memory usage
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../aqg-network-analyzer/gcp-packet-mirroring-tutorial/">
<span class="md-ellipsis">
    GCP Packet Mirroring Tutorial
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../aqg-network-analyzer/troubleshooting/">
<span class="md-ellipsis">
    Troubleshooting
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../aqg-network-analyzer/reference/">
<span class="md-ellipsis">
    Reference
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
<span class="md-ellipsis">
<ff flags="EnableAwsV2"></ff>AWS
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
<span class="md-ellipsis">
<ff flags="EnableAwsV2"></ff>AWS
  </span>
</a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#data-ingestion-overview">
<span class="md-ellipsis">
      Data ingestion overview
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#tags">
<span class="md-ellipsis">
      Tags
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#aws-services-and-api-permissions">
<span class="md-ellipsis">
      AWS services and API permissions
    </span>
</a>
<nav aria-label="AWS services and API permissions" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#aws-security-token-service-sts">
<span class="md-ellipsis">
      AWS Security Token Service (STS)
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#aws-key-management-service-kms">
<span class="md-ellipsis">
      AWS Key Management Service (KMS)
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#aws-certificate-manager-acm">
<span class="md-ellipsis">
      AWS Certificate Manager (ACM)
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#aws-secrets-manager">
<span class="md-ellipsis">
      AWS Secrets Manager
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#aws-systems-manager-ssm">
<span class="md-ellipsis">
      AWS Systems Manager (SSM)
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#before-you-begin">
<span class="md-ellipsis">
      Before you begin
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#choose-your-deployment-method">
<span class="md-ellipsis">
      Choose your deployment method
    </span>
</a>
<nav aria-label="Choose your deployment method" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#single-region-setup">
<span class="md-ellipsis">
      Single region setup
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#manual-multi-region-setup">
<span class="md-ellipsis">
      Manual multi-region setup
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#aws-stacksets">
<span class="md-ellipsis">
      AWS StackSets
    </span>
</a>
<nav aria-label="AWS StackSets" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#configure-iam-roles-for-stacksets">
<span class="md-ellipsis">
      Configure IAM Roles for StackSets
    </span>
</a>
<nav aria-label="Configure IAM Roles for StackSets" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#admin-role">
<span class="md-ellipsis">
      Admin role
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#execution-role">
<span class="md-ellipsis">
      Execution Role
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#stackset-deployment-process-and-configuration">
<span class="md-ellipsis">
      StackSet deployment process and configuration
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#finish-setup-in-aqg">
<span class="md-ellipsis">
      Finish setup in AQG
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#use">
<span class="md-ellipsis">
      Use
    </span>
</a>
<nav aria-label="Use" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#start-an-ingestion">
<span class="md-ellipsis">
      Start an ingestion
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#edit-a-connected-aws-account">
<span class="md-ellipsis">
      Edit a connected AWS account
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#unlink-the-aws-integration">
<span class="md-ellipsis">
      Unlink the AWS integration
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#troubleshooting">
<span class="md-ellipsis">
      Troubleshooting
    </span>
</a>
<nav aria-label="Troubleshooting" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#aqtive-guard-cloudformation-template">
<span class="md-ellipsis">
      AQtive Guard CloudFormation template
    </span>
</a>
<nav aria-label="AQtive Guard CloudFormation template" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#verify-eventbridge-rule">
<span class="md-ellipsis">
      Verify EventBridge rule
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#verify-rule-target">
<span class="md-ellipsis">
      Verify rule target
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#check-connection-authorization">
<span class="md-ellipsis">
      Check connection authorization
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#aws-stacksets-troubleshooting">
<span class="md-ellipsis">
      AWS StackSets troubleshooting
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#custom-setup">
<span class="md-ellipsis">
      Custom setup
    </span>
</a>
<nav aria-label="Custom setup" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#verify-rule-state">
<span class="md-ellipsis">
      Verify rule state
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#verify-rule-target_1">
<span class="md-ellipsis">
      Verify rule target
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#check-connection-authorization_1">
<span class="md-ellipsis">
      Check connection authorization
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#re-authenticate-the-connection">
<span class="md-ellipsis">
      Re-authenticate the connection
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../aws-kms/">
<span class="md-ellipsis">
<ff flags="EnableAwsKmsDataSource"></ff>AWS Key Management Service
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../cbom/">
<span class="md-ellipsis">
    CBOM
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../crowdstrike/">
<span class="md-ellipsis">
    CrowdStrike
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../github/">
<span class="md-ellipsis">
    GitHub
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../palo-alto-networks/">
<span class="md-ellipsis">
    Palo Alto Networks
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../qualys/">
<span class="md-ellipsis">
    Qualys
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../sentinelone/">
<span class="md-ellipsis">
    SentinelOne
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../servicenow/">
<span class="md-ellipsis">
    ServiceNow
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_19" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../../aqg-mcp/">
<span class="md-ellipsis">
    AQtive Guard MCP server
  </span>
</a>
<label class="md-nav__link" for="__nav_19" id="__nav_19_label" tabindex="0">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_19_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_19">
<span class="md-nav__icon md-icon"></span>
            AQtive Guard MCP server
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../aqg-mcp/getting-started/">
<span class="md-ellipsis">
    Getting started
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_20" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../../ai-spm-rules-reference/">
<span class="md-ellipsis">
    AI-SPM rules reference
  </span>
</a>
<label class="md-nav__link" for="__nav_20" id="__nav_20_label" tabindex="0">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_20_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_20">
<span class="md-nav__icon md-icon"></span>
            AI-SPM rules reference
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../ai-spm-rules-reference/excessive-tool-autonomy-without-guardrails-4/">
<span class="md-ellipsis">
    Excessive tool autonomy without guardrails
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../ai-spm-rules-reference/insufficient-guardrail-coverage-for-tools-5/">
<span class="md-ellipsis">
    Insufficient guardrails for tools
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../ai-spm-rules-reference/low-jailbreak-resistance-score-7/">
<span class="md-ellipsis">
    Low jailbreak resistance score
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../ai-spm-rules-reference/low-misuse-score-10/">
<span class="md-ellipsis">
    Low misuse score
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../ai-spm-rules-reference/low-overall-evaluation-score-12/">
<span class="md-ellipsis">
    Low overall evaluation score
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../ai-spm-rules-reference/low-robustness-score-8/">
<span class="md-ellipsis">
    Low robustness score
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../ai-spm-rules-reference/low-security-score-9/">
<span class="md-ellipsis">
    Low security score
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../ai-spm-rules-reference/low-toxicity-resistance-score-11/">
<span class="md-ellipsis">
    Low toxicity resistance score
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../ai-spm-rules-reference/missing-agent-metadata-1b/">
<span class="md-ellipsis">
    Missing agent metadata
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../ai-spm-rules-reference/missing-input-guardrails-3/">
<span class="md-ellipsis">
    Missing input guardrails
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../ai-spm-rules-reference/missing-model-evaluation-6/">
<span class="md-ellipsis">
    Missing model evaluation
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../ai-spm-rules-reference/missing-model-metadata-1a/">
<span class="md-ellipsis">
    Missing model metadata
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../ai-spm-rules-reference/missing-output-guardrails-2/">
<span class="md-ellipsis">
    Missing output guardrails
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../ai-spm-rules-reference/model-serialization-issues-detected-13/">
<span class="md-ellipsis">
    Model serialization issues detected
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_21" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../../cryptography-rules-reference/">
<span class="md-ellipsis">
    Cryptography rules reference
  </span>
</a>
<label class="md-nav__link" for="__nav_21" id="__nav_21_label" tabindex="0">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_21_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_21">
<span class="md-nav__icon md-icon"></span>
            Cryptography rules reference
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../cryptography-rules-reference/certificate_validity-too-long-64/">
<span class="md-ellipsis">
    Certificate validity too long
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../cryptography-rules-reference/key_diffie-hellman-group-too-small-4/">
<span class="md-ellipsis">
    Diffie Hellman key too short
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../cryptography-rules-reference/key_elliptic-curve_key-too-short-3/">
<span class="md-ellipsis">
    Elliptic curve key too short
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../cryptography-rules-reference/certificate_invalid-certificate-63/">
<span class="md-ellipsis">
    Expired certificate
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../cryptography-rules-reference/tls-config-version-vuln-004/">
<span class="md-ellipsis">
    Host supports usage of a TLS version strictly less than 1.2
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../cryptography-rules-reference/ciphersuite_offered-ciphersuite-with-3des-tls-47/">
<span class="md-ellipsis">
    Offered ciphersuite with 3DES
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../cryptography-rules-reference/ciphersuite_offered-ciphersuite-with-des-tls-46/">
<span class="md-ellipsis">
    Offered ciphersuite with DES
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../cryptography-rules-reference/ciphersuite_offered-ciphersuite-with-rc4-tls-50/">
<span class="md-ellipsis">
    Offered ciphersuite with RC4
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../cryptography-rules-reference/ciphersuite_offered-quantum-vulnerable-kex-005/">
<span class="md-ellipsis">
    Offered quantum-vulnerable key exchange mechanism on network connection
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../cryptography-rules-reference/algorithm_offered-quantum-vulnerable-signature-algorithms-network-connection-81/">
<span class="md-ellipsis">
    Offered quantum-vulnerable signature algorithms on network connection
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../cryptography-rules-reference/ciphersuite_offered-tls-less-1-2-77/">
<span class="md-ellipsis">
    Offered TLS version lower than 1.2
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../cryptography-rules-reference/algorithm_use-of-low-encryption-exponent-58/">
<span class="md-ellipsis">
    RSA key exponent too low
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../cryptography-rules-reference/key_rsa_key-too-short-1/">
<span class="md-ellipsis">
    RSA key too short
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../cryptography-rules-reference/key_stale-private-key-202/">
<span class="md-ellipsis">
    Stale key
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../cryptography-rules-reference/key_storage-of-keys-in-a-weak-keystore-21/">
<span class="md-ellipsis">
    Storage of keys in a weak keystore
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../cryptography-rules-reference/key_symmetric-key-too-short-2/">
<span class="md-ellipsis">
    Symmetric key too short
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../cryptography-rules-reference/key_unencrypted-private-key-201/">
<span class="md-ellipsis">
    Unencrypted private key
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../cryptography-rules-reference/ciphersuite_use-of-ciphersuite-with-3des-tls-79/">
<span class="md-ellipsis">
    Use of cipher suite with 3DES
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../cryptography-rules-reference/ciphersuite_use-of-ciphersuite-with-des-tls-78/">
<span class="md-ellipsis">
    Use of cipher suite with DES
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../cryptography-rules-reference/ciphersuite_use-of-ciphersuite-with-rc4-tls-80/">
<span class="md-ellipsis">
    Use of cipher suite with RC4
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../cryptography-rules-reference/algorithm_use-of-default-cipher-mode-10/">
<span class="md-ellipsis">
    Use of default cipher mode
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../cryptography-rules-reference/algorithm_use-of-3DES-in-operations/">
<span class="md-ellipsis">
    Use of 3DES encryption algorithm in operations
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../cryptography-rules-reference/key_dsa_key-too-short-42/">
<span class="md-ellipsis">
    Use of DSA
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../cryptography-rules-reference/algorithm_use-of-ecb-mode-8/">
<span class="md-ellipsis">
    Use of Electronic Code Book (ECB) mode
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../cryptography-rules-reference/algorithm_use-of-pkcs1v15-encryption-9/">
<span class="md-ellipsis">
    Use of PKCS#1v1.5 Encryption
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../cryptography-rules-reference/algorithm_use-of-pkcs1v15-signature-38/">
<span class="md-ellipsis">
    Use of PKCS#1v1.5 Signature
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../cryptography-rules-reference/algorithm_use-of-quantum-vulnerable-key-establishment-68/">
<span class="md-ellipsis">
    Use of quantum-vulnerable key-establishment scheme
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../cryptography-rules-reference/ciphersuite_use-of-quantum-vulnerable-server-auth-003/">
<span class="md-ellipsis">
    Use of quantum-vulnerable server authentication
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../cryptography-rules-reference/algorithm_use-of-md2-hash-function-34/">
<span class="md-ellipsis">
    Use of the MD2 hash function
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../cryptography-rules-reference/hashfunction_use-of-the-md5-hash-function-12/">
<span class="md-ellipsis">
    Use of the MD5 hash function
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../cryptography-rules-reference/hashfunction_use-of-sha1-11/">
<span class="md-ellipsis">
    Use of the SHA1 hash function
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../cryptography-rules-reference/ciphersuite_use-of-tls-less-1-2-76/">
<span class="md-ellipsis">
    Use of TLS version lower than 1.2
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../cryptography-rules-reference/certificate_weak-hash-function-74/">
<span class="md-ellipsis">
    Weak hash function in certificate
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../cryptography-rules-reference/algorithm_quantum-vulnerable-public-key-operation/">
<span class="md-ellipsis">
    Quantum-vulnerable public-key cryptography operation
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_22" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../../kb-articles/">
<span class="md-ellipsis">
    Knowledge base
  </span>
</a>
<label class="md-nav__link" for="__nav_22" id="__nav_22_label" tabindex="0">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_22_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_22">
<span class="md-nav__icon md-icon"></span>
            Knowledge base
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../kb-articles/block-and-stream-ciphers/">
<span class="md-ellipsis">
    Block and stream ciphers
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../kb-articles/certificates/">
<span class="md-ellipsis">
    Certificates
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../kb-articles/chosen-ciphertext-attacks/">
<span class="md-ellipsis">
    Chosen ciphertext attacks
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../kb-articles/computational-resources-in-cryptanalysis/">
<span class="md-ellipsis">
    Computational resources in cryptanalysis
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../kb-articles/cryptographic-keylengths/">
<span class="md-ellipsis">
    Cryptographic keylengths
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../kb-articles/cryptography-bill-of-materials/">
<span class="md-ellipsis">
    Cryptography Bill of Materials (CBOM)
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../kb-articles/elliptic-curve-cryptography/">
<span class="md-ellipsis">
    Elliptic curve cryptography
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../kb-articles/hash-functions/">
<span class="md-ellipsis">
    Hash functions
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../kb-articles/key-management-and-keystores/">
<span class="md-ellipsis">
    Key management and keystores
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../kb-articles/lack-of-strong-unforgeability/">
<span class="md-ellipsis">
    Lack of strong unforgeability
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../kb-articles/message-authentication-codes/">
<span class="md-ellipsis">
    Message authentication codes (MACs)
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../kb-articles/password-based-key-derivation/">
<span class="md-ellipsis">
    Password-based Key Derivation
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../kb-articles/preparing-for-fips-validation/">
<span class="md-ellipsis">
    Preparing for FIPS validation
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../kb-articles/quantum-threat/">
<span class="md-ellipsis">
    Quantum threat
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../kb-articles/rsa-algorithm/">
<span class="md-ellipsis">
    RSA algorithm
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../kb-articles/timing-attacks-and-broader-side-channel-attacks/">
<span class="md-ellipsis">
    Timing attacks and broader side-channel attacks
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../kb-articles/transport-layer-security-tls/">
<span class="md-ellipsis">
    Transport Layer Security (TLS)
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../kb-articles/weak-cryptography-keys/">
<span class="md-ellipsis">
    Weak cryptography keys
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../cryptography-glossary/">
<span class="md-ellipsis">
    Cryptography glossary
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../api/">
<span class="md-ellipsis">
    API Reference
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../manage-your-data/">
<span class="md-ellipsis">
    How we manage your data
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../accessibility-statement/">
<span class="md-ellipsis">
    Accessibility statement
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../use-conditions-statement/">
<span class="md-ellipsis">
    Use conditions statement
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../changelog/">
<span class="md-ellipsis">
    Changelog
  </span>
</a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#data-ingestion-overview">
<span class="md-ellipsis">
      Data ingestion overview
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#tags">
<span class="md-ellipsis">
      Tags
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#aws-services-and-api-permissions">
<span class="md-ellipsis">
      AWS services and API permissions
    </span>
</a>
<nav aria-label="AWS services and API permissions" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#aws-security-token-service-sts">
<span class="md-ellipsis">
      AWS Security Token Service (STS)
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#aws-key-management-service-kms">
<span class="md-ellipsis">
      AWS Key Management Service (KMS)
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#aws-certificate-manager-acm">
<span class="md-ellipsis">
      AWS Certificate Manager (ACM)
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#aws-secrets-manager">
<span class="md-ellipsis">
      AWS Secrets Manager
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#aws-systems-manager-ssm">
<span class="md-ellipsis">
      AWS Systems Manager (SSM)
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#before-you-begin">
<span class="md-ellipsis">
      Before you begin
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#choose-your-deployment-method">
<span class="md-ellipsis">
      Choose your deployment method
    </span>
</a>
<nav aria-label="Choose your deployment method" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#single-region-setup">
<span class="md-ellipsis">
      Single region setup
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#manual-multi-region-setup">
<span class="md-ellipsis">
      Manual multi-region setup
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#aws-stacksets">
<span class="md-ellipsis">
      AWS StackSets
    </span>
</a>
<nav aria-label="AWS StackSets" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#configure-iam-roles-for-stacksets">
<span class="md-ellipsis">
      Configure IAM Roles for StackSets
    </span>
</a>
<nav aria-label="Configure IAM Roles for StackSets" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#admin-role">
<span class="md-ellipsis">
      Admin role
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#execution-role">
<span class="md-ellipsis">
      Execution Role
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#stackset-deployment-process-and-configuration">
<span class="md-ellipsis">
      StackSet deployment process and configuration
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#finish-setup-in-aqg">
<span class="md-ellipsis">
      Finish setup in AQG
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#use">
<span class="md-ellipsis">
      Use
    </span>
</a>
<nav aria-label="Use" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#start-an-ingestion">
<span class="md-ellipsis">
      Start an ingestion
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#edit-a-connected-aws-account">
<span class="md-ellipsis">
      Edit a connected AWS account
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#unlink-the-aws-integration">
<span class="md-ellipsis">
      Unlink the AWS integration
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#troubleshooting">
<span class="md-ellipsis">
      Troubleshooting
    </span>
</a>
<nav aria-label="Troubleshooting" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#aqtive-guard-cloudformation-template">
<span class="md-ellipsis">
      AQtive Guard CloudFormation template
    </span>
</a>
<nav aria-label="AQtive Guard CloudFormation template" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#verify-eventbridge-rule">
<span class="md-ellipsis">
      Verify EventBridge rule
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#verify-rule-target">
<span class="md-ellipsis">
      Verify rule target
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#check-connection-authorization">
<span class="md-ellipsis">
      Check connection authorization
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#aws-stacksets-troubleshooting">
<span class="md-ellipsis">
      AWS StackSets troubleshooting
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#custom-setup">
<span class="md-ellipsis">
      Custom setup
    </span>
</a>
<nav aria-label="Custom setup" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#verify-rule-state">
<span class="md-ellipsis">
      Verify rule state
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#verify-rule-target_1">
<span class="md-ellipsis">
      Verify rule target
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#check-connection-authorization_1">
<span class="md-ellipsis">
      Check connection authorization
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#re-authenticate-the-connection">
<span class="md-ellipsis">
      Re-authenticate the connection
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<h1 id="amazon-web-services-aws">Amazon Web Services (AWS)<a class="headerlink" href="#amazon-web-services-aws" title="Permanent link"></a></h1>
<p>The AQtive Guard (AQG) Amazon Web Services (AWS) integration provides a comprehensive view of cryptographic assets and how theyre used in your AWS environment.</p>
<p>AQG connects to your AWS account in an agentless manner, using an IAM role that follows the least-privilege principle to scan and discover your cryptographic inventory.</p>
<h2 id="data-ingestion-overview">Data ingestion overview<a class="headerlink" href="#data-ingestion-overview" title="Permanent link"></a></h2>
<p>The AWS integration discovers and inventories a wide range of cryptographic assets, including:</p>
<ul>
<li>Certificates from AWS Certificate Manager (ACM)</li>
<li>Keys from AWS Key Management Service (KMS)</li>
<li>Secrets from AWS Secrets Manager and AWS Systems Manager (SSM)</li>
<li>EC2 instances, Lambda functions, API Gateway endpoints, and other AWS resources that use these cryptographic assets</li>
</ul>
<p>The AWS integration uses CloudTrail events to maintain the inventory of cryptographic assets, and to discover other AWS resources that use the cryptographic assets.</p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>We use EventBridge to forward CloudTrail events to AQtive Guard for processing. To prevent an infinite loop, we filter out any events where the source IP is <code>apidestinations.events.amazonaws.com</code>, as these are events generated by EventBridge forwarding activity.</p>
</div>
<h2 id="tags">Tags<a class="headerlink" href="#tags" title="Permanent link"></a></h2>
<p>The AWS integration will automatically ingest any <em>user-defined</em> tags applied to your resources in AWS as tags in AQtive Guard. <em>AWS-generated</em> tags are not ingested. Refer to the <a href="https://docs.aws.amazon.com/whitepapers/latest/tagging-best-practices/what-are-tags.html" rel="noopener" target="_blank">AWS tags documentation</a> for more information.</p>
<h2 id="aws-services-and-api-permissions">AWS services and API permissions<a class="headerlink" href="#aws-services-and-api-permissions" title="Permanent link"></a></h2>
<p>The AWS integration uses specific API calls to discover and ingest cryptographic asset data from your AWS account. This section details the AWS services AQG interacts with and the corresponding APIs it calls.</p>
<h3 id="aws-security-token-service-sts">AWS Security Token Service (STS)<a class="headerlink" href="#aws-security-token-service-sts" title="Permanent link"></a></h3>
<p>AQG uses the STS service to assume roles within your AWS account.</p>
<ul>
<li><code>sts:GetCallerIdentity</code></li>
</ul>
<p>For more information, refer to the <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_iam-quotas.html" rel="noopener" target="_blank">AWS STS documentation</a>.</p>
<h3 id="aws-key-management-service-kms">AWS Key Management Service (KMS)<a class="headerlink" href="#aws-key-management-service-kms" title="Permanent link"></a></h3>
<p>AQG discovers cryptographic keys and their properties from the AWS KMS service.</p>
<ul>
<li><code>kms:ListKeys</code></li>
<li><code>kms:ListAliases</code></li>
<li><code>kms:DescribeKey</code></li>
<li><code>kms:GetKeyPolicy</code></li>
<li><code>kms:GetKeyRotationStatus</code></li>
</ul>
<p>For more information, refer to the <a href="https://docs.aws.amazon.com/general/latest/gr/kms.html" rel="noopener" target="_blank">AWS KMS documentation</a>.</p>
<h3 id="aws-certificate-manager-acm">AWS Certificate Manager (ACM)<a class="headerlink" href="#aws-certificate-manager-acm" title="Permanent link"></a></h3>
<p>For certificate discovery, AQG interacts with the ACM service.</p>
<ul>
<li><code>acm:GetCertificate</code></li>
<li><code>acm:ListCertificates</code></li>
<li><code>acm:DescribeCertificate</code></li>
</ul>
<p>For more information, refer to the <a href="https://docs.aws.amazon.com/acm/latest/userguide/acm-limits.html" rel="noopener" target="_blank">AWS ACM documentation</a>.</p>
<h3 id="aws-secrets-manager">AWS Secrets Manager<a class="headerlink" href="#aws-secrets-manager" title="Permanent link"></a></h3>
<p>AQG uses the following APIs to discover and inventory secrets stored in AWS Secrets Manager.</p>
<ul>
<li><code>secretsmanager:ListSecrets</code></li>
<li><code>secretsmanager:DescribeSecret</code></li>
</ul>
<p>For more information, refer to the <a href="https://docs.aws.amazon.com/secretsmanager/latest/userguide/reference_limits.html" rel="noopener" target="_blank">AWS Secrets Manager documentation</a>.</p>
<h3 id="aws-systems-manager-ssm">AWS Systems Manager (SSM)<a class="headerlink" href="#aws-systems-manager-ssm" title="Permanent link"></a></h3>
<p>AQG discovers and inventories SSM Parameters, which are treated as secrets.</p>
<ul>
<li><code>ssm:DescribeParameters</code></li>
<li><code>ssm:ListTagsForResource</code></li>
</ul>
<p>For more information, refer to the <a href="https://docs.aws.amazon.com/general/latest/gr/ssm.html" rel="noopener" target="_blank">AWS SSM documentation</a>.</p>
<h2 id="before-you-begin">Before you begin<a class="headerlink" href="#before-you-begin" title="Permanent link"></a></h2>
<p>To set up the AWS integration, youll need the <strong>CloudFormation Template</strong> from AQG.</p>
<ol>
<li>Log in to AQtive Guard and select <strong>Data sources</strong> from the main menu.  </li>
<li>Select <strong>Configure</strong> in the <em>AWS</em> panel, then <strong>Download CloudFormation template</strong>. Youll need it to complete the integration. </li>
</ol>
<h2 id="choose-your-deployment-method">Choose your deployment method<a class="headerlink" href="#choose-your-deployment-method" title="Permanent link"></a></h2>
<p>Depending on your organizations needs, choose one of the following three methods to run the template in your AWS account.</p>
<ul>
<li><a href="#single-region-setup">Single region setup</a> - Use this method if you only need to monitor a single AWS region.  </li>
<li><a href="#manual-multi-region-setup">Manual multi-region setup</a> - Use this method if you want to monitor multiple regions without setting up additional IAM roles for orchestration.  </li>
<li><a href="#aws-stacksets">AWS StackSets</a> - Use this method if you want to monitor multiple regions using CloudFormations StackSets to deploy stacks into multiple regions simultaneously.</li>
</ul>
<p>Refer to the linked sections for details.</p>
<h3 id="single-region-setup">Single region setup<a class="headerlink" href="#single-region-setup" title="Permanent link"></a></h3>
<p>Use this method if you only need to monitor a single AWS region.</p>
<ol>
<li>Log into the AWS console.</li>
<li>From the AWS dashboard, search for and then select <strong>CloudFormation</strong>.</li>
<li>
<p>Select <em>Stacks</em> in the left navigation pane, then select <strong>Create stack</strong>:</p>
<ul>
<li>If this is your first stack, select the orange <strong>Create stack</strong> button.</li>
</ul>
<ul>
<li>If you have existing stacks, select the <strong>Create stack</strong> button in the top-right corner and select <strong>With new resources (standard)</strong> from the dropdown.</li>
</ul>
</li>
<li>
<p>In the <em>Prerequisite - Prepare template</em> section, verify <strong>Choose an existing template</strong> is selected.</p>
</li>
<li>In the <em>Specify template</em> section, select <strong>Upload a template file</strong>.</li>
<li>Select <strong>Choose file</strong>, upload the template you downloaded from AQG, and select <strong>Next</strong>.</li>
<li>
<p>On the <em>Specify stack details</em> page:</p>
<ul>
<li>Enter a <strong>Stack name</strong>.</li>
</ul>
<ul>
<li>
<p>Enter your <strong>AQGAPIKeyParameter</strong>. If you dont have a key, you can browse to the URL listed directly under this field in the AWS console to generate the required API token in AQtive Guard. The token should have at least <strong>Uploader</strong> permissions. Refer to <a href="../../settings/#create-an-api-token">Create an API token</a> for instructions.</p>
<p>Then select <strong>Next</strong>. Refer to the <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/stacks.html" rel="noopener" target="_blank">AWS stacks documentation</a> for more information.</p>
</li>
</ul>
</li>
<li>
<p>At the bottom of the next page, check the box <strong>I acknowledge that AWS CloudFormation might create IAM resources with customized names</strong> and select <strong>Next</strong>.</p>
</li>
<li>Select <strong>Submit</strong>.</li>
<li>Once the stack is created, navigate to the stacks <em>Outputs</em> tab and copy the <strong>Amazon Resource Name (ARN)</strong> of the created IAM role named <code>AQtiveGuardReadOnlyAccessRole</code>.</li>
</ol>
<h3 id="manual-multi-region-setup">Manual multi-region setup<a class="headerlink" href="#manual-multi-region-setup" title="Permanent link"></a></h3>
<p>Use this method if you want to monitor multiple regions without setting up additional IAM roles for orchestration.</p>
<ol>
<li>Complete the steps for the <strong><a href="#single-region-setup">Single region setup</a></strong> in your first region (for example, <code>us-east-1</code>).</li>
<li>Once the first stack is finished, switch your AWS console to a different region (for example, <code>us-west-2</code>).</li>
<li>Repeat the process for creating stacks using the same template.</li>
<li>Continue this process for every region you wish to monitor.</li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You only need to copy the <strong>Amazon Resource Name (ARN)</strong> from your <strong>primary region</strong> stack to finish the setup in AQG.</p>
</div>
<h3 id="aws-stacksets">AWS StackSets<a class="headerlink" href="#aws-stacksets" title="Permanent link"></a></h3>
<p>This approach involves using CloudFormations <a href="https://docs.aws.amazon.com/servicecatalog/latest/adminguide/using-stacksets.html" rel="noopener" target="_blank">StackSets</a> to deploy stacks into multiple regions simultaneously.</p>
<h4 id="configure-iam-roles-for-stacksets">Configure IAM Roles for StackSets<a class="headerlink" href="#configure-iam-roles-for-stacksets" title="Permanent link"></a></h4>
<p>Before uploading the template, youll need to first configure two specific IAM roles:</p>
<h5 id="admin-role">Admin role<a class="headerlink" href="#admin-role" title="Permanent link"></a></h5>
<p>The <em>Admin</em> role allows the CloudFormation service to manage your StackSets.</p>
<ol>
<li>Log in to the <strong>IAM Console</strong>.</li>
<li>Select <strong>Roles</strong>, then <strong>Create role</strong>.</li>
<li>For <strong>Trusted entity type</strong>, select <strong>Custom trust policy</strong> and paste the following:
    <div class="highlight"><span class="filename">JSON</span><pre><span></span><code><a href="#__codelineno-0-1" id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="p">{</span>
<a href="#__codelineno-0-2" id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="w">    </span><span class="nt">"Version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2012-10-17"</span><span class="p">,</span>
<a href="#__codelineno-0-3" id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="w">    </span><span class="nt">"Statement"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<a href="#__codelineno-0-4" id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="w">        </span><span class="p">{</span>
<a href="#__codelineno-0-5" id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="w">            </span><span class="nt">"Effect"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Allow"</span><span class="p">,</span>
<a href="#__codelineno-0-6" id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="w">            </span><span class="nt">"Principal"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-0-7" id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="w">                </span><span class="nt">"Service"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cloudformation.amazonaws.com"</span>
<a href="#__codelineno-0-8" id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="w">            </span><span class="p">},</span>
<a href="#__codelineno-0-9" id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="w">            </span><span class="nt">"Action"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sts:AssumeRole"</span>
<a href="#__codelineno-0-10" id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="w">        </span><span class="p">}</span>
<a href="#__codelineno-0-11" id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="w">    </span><span class="p">]</span>
<a href="#__codelineno-0-12" id="__codelineno-0-12" name="__codelineno-0-12"></a><span class="p">}</span>
</code></pre></div></li>
<li>Select <strong>Next</strong>. </li>
<li>Select the AWS managed policy <code>AWSCloudFormationFullAccess</code>, then select <strong>Next</strong>.</li>
<li>Add a <em>Role name</em> and any required <em>Tags</em>, then select <strong>Create role</strong>.</li>
<li>Locate your newly created role in the <em>IAM Roles</em> list and select its name to view the details.</li>
<li>In the <em>Permission policies</em> section, select the <strong>Add permissions</strong> dropdown and select <strong>Create inline policy</strong>.</li>
<li>Select the <strong>JSON</strong> tab and paste the following:
    <div class="highlight"><span class="filename">JSON</span><pre><span></span><code><a href="#__codelineno-1-1" id="__codelineno-1-1" name="__codelineno-1-1"></a><span class="p">{</span>
<a href="#__codelineno-1-2" id="__codelineno-1-2" name="__codelineno-1-2"></a><span class="w">    </span><span class="nt">"Version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2012-10-17"</span><span class="p">,</span>
<a href="#__codelineno-1-3" id="__codelineno-1-3" name="__codelineno-1-3"></a><span class="w">    </span><span class="nt">"Statement"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<a href="#__codelineno-1-4" id="__codelineno-1-4" name="__codelineno-1-4"></a><span class="w">        </span><span class="p">{</span>
<a href="#__codelineno-1-5" id="__codelineno-1-5" name="__codelineno-1-5"></a><span class="w">            </span><span class="nt">"Effect"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Allow"</span><span class="p">,</span>
<a href="#__codelineno-1-6" id="__codelineno-1-6" name="__codelineno-1-6"></a><span class="w">            </span><span class="nt">"Action"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<a href="#__codelineno-1-7" id="__codelineno-1-7" name="__codelineno-1-7"></a><span class="w">                </span><span class="s2">"cloudformation:*StackSet*"</span><span class="p">,</span>
<a href="#__codelineno-1-8" id="__codelineno-1-8" name="__codelineno-1-8"></a><span class="w">                </span><span class="s2">"iam:PassRole"</span><span class="p">,</span>
<a href="#__codelineno-1-9" id="__codelineno-1-9" name="__codelineno-1-9"></a><span class="w">                </span><span class="s2">"sts:AssumeRole"</span>
<a href="#__codelineno-1-10" id="__codelineno-1-10" name="__codelineno-1-10"></a><span class="w">            </span><span class="p">],</span>
<a href="#__codelineno-1-11" id="__codelineno-1-11" name="__codelineno-1-11"></a><span class="w">            </span><span class="nt">"Resource"</span><span class="p">:</span><span class="w"> </span><span class="s2">"*"</span>
<a href="#__codelineno-1-12" id="__codelineno-1-12" name="__codelineno-1-12"></a><span class="w">        </span><span class="p">}</span>
<a href="#__codelineno-1-13" id="__codelineno-1-13" name="__codelineno-1-13"></a><span class="w">    </span><span class="p">]</span>
<a href="#__codelineno-1-14" id="__codelineno-1-14" name="__codelineno-1-14"></a><span class="p">}</span>
</code></pre></div></li>
<li>Name the policy (for example, StackSetAdminInlinePolicy), then select <strong>Create policy</strong>.</li>
</ol>
<h5 id="execution-role">Execution Role<a class="headerlink" href="#execution-role" title="Permanent link"></a></h5>
<p>The <em>Execution</em> role assumes the stack creation process in different regions.</p>
<ol>
<li>In the <strong>IAM Console</strong>, select <strong>Roles</strong>, then <strong>Create role</strong>.</li>
<li>For <strong>Trusted entity type</strong>, select <strong>Custom trust policy</strong> and paste the following, replacing <code>&lt;ADMIN ROLE ARN&gt;</code> with the ARN of the Admin role created in <a href="#admin-role">admin role</a>):
    <div class="highlight"><span class="filename">JSON</span><pre><span></span><code><a href="#__codelineno-2-1" id="__codelineno-2-1" name="__codelineno-2-1"></a><span class="p">{</span>
<a href="#__codelineno-2-2" id="__codelineno-2-2" name="__codelineno-2-2"></a><span class="w">    </span><span class="nt">"Version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2012-10-17"</span><span class="p">,</span>
<a href="#__codelineno-2-3" id="__codelineno-2-3" name="__codelineno-2-3"></a><span class="w">    </span><span class="nt">"Statement"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<a href="#__codelineno-2-4" id="__codelineno-2-4" name="__codelineno-2-4"></a><span class="w">        </span><span class="p">{</span>
<a href="#__codelineno-2-5" id="__codelineno-2-5" name="__codelineno-2-5"></a><span class="w">            </span><span class="nt">"Effect"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Allow"</span><span class="p">,</span>
<a href="#__codelineno-2-6" id="__codelineno-2-6" name="__codelineno-2-6"></a><span class="w">            </span><span class="nt">"Principal"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-2-7" id="__codelineno-2-7" name="__codelineno-2-7"></a><span class="w">                </span><span class="nt">"AWS"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;ADMIN ROLE ARN&gt;"</span>
<a href="#__codelineno-2-8" id="__codelineno-2-8" name="__codelineno-2-8"></a><span class="w">            </span><span class="p">},</span>
<a href="#__codelineno-2-9" id="__codelineno-2-9" name="__codelineno-2-9"></a><span class="w">            </span><span class="nt">"Action"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sts:AssumeRole"</span>
<a href="#__codelineno-2-10" id="__codelineno-2-10" name="__codelineno-2-10"></a><span class="w">        </span><span class="p">}</span>
<a href="#__codelineno-2-11" id="__codelineno-2-11" name="__codelineno-2-11"></a><span class="w">    </span><span class="p">]</span>
<a href="#__codelineno-2-12" id="__codelineno-2-12" name="__codelineno-2-12"></a><span class="p">}</span>
</code></pre></div></li>
<li>Select <strong>Next</strong>.</li>
<li>Select the AWS managed policy <code>AdministratorAccess</code>.</li>
<li>Name the role <code>AWSCloudFormationStackSetExecutionRole</code> and select <strong>Create role</strong>.</li>
</ol>
<h4 id="stackset-deployment-process-and-configuration">StackSet deployment process and configuration<a class="headerlink" href="#stackset-deployment-process-and-configuration" title="Permanent link"></a></h4>
<ol>
<li>Log into the AWS console and navigate to <strong>CloudFormation</strong>. </li>
<li>Select <strong>StackSets</strong>, then <strong>Create stack set</strong>.</li>
<li>Select the desired <em>Admin</em> and <em>Execution</em> roles.</li>
<li>
<p>Upload the <code>cloudformation-template.json</code> file that you downloaded previously.</p>
</li>
<li>
<p>On the <em>Specify stack details</em> page:</p>
<ul>
<li>Enter a <strong>Stack name</strong>.</li>
</ul>
<ul>
<li>Enter your <strong>AQGAPIKeyParameter</strong>. If you dont have a key, you can browse to the URL listed directly under this field in the AWS console to generate the required API token in AQtive Guard. The token should have at least <strong>Uploader</strong> permissions. Refer to <a href="../../settings/#create-an-api-token">Create an API token</a> for instructions.</li>
</ul>
<ul>
<li>
<p>Select your central hub region from the <strong>PrimaryRegion</strong> dropdown.</p>
<p>Then select <strong>Next</strong>. Refer to the <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/stacks.html" rel="noopener" target="_blank">AWS stacks documentation</a> for more information.</p>
</li>
</ul>
</li>
<li>
<p>Under <strong>Execution configuration</strong>, select whichever option better suits your environment.</p>
</li>
<li>Check the box <strong>I acknowledge that AWS CloudFormation might create IAM resources with customized names</strong> and select <strong>Next</strong>.</li>
<li>In the <em>Add stacks to stack set</em> section, verify that <strong>Deploy new stacks</strong> is selected. </li>
<li>
<p>In the <em>Accounts area</em>, verify that <strong>Deploy stacks in accounts</strong> is selected and add the <strong>Account number</strong>. </p>
<p>You can find your 12-digit account number by selecting your account name in the top-right corner of the AWS Console, or by looking at your roles ARN. In the ARN, its the numeric segment (for example, <code>arn:aws:iam::</code><strong><code>123456789012</code></strong><code>:role/...</code>)</p>
</li>
<li>
<p>In the <strong>Specify regions</strong> area, select all regions you wish to monitor. You <strong>must</strong> pick at least the same region you selected earlier as the <strong>PrimaryRegion</strong>.</p>
</li>
<li>Configure any <strong>Deployment options</strong> you want to be active. We recommend setting your <strong>Failure tolerance</strong> to <code>0</code>. This will catch any errors immediately.</li>
<li>Select <strong>Submit</strong>.</li>
</ol>
<h3 id="finish-setup-in-aqg">Finish setup in AQG<a class="headerlink" href="#finish-setup-in-aqg" title="Permanent link"></a></h3>
<p>Complete the following steps in AQG to finish the setup.</p>
<ol>
<li>Log in to AQtive Guard and select <strong>Data sources</strong> from the main menu.</li>
<li>Select <strong>Configure</strong> in the <em>AWS</em> panel.</li>
<li>Enter the <em>Amazon Resource Name (ARN)</em> for the role you created in the AWS console (if using StackSets, use the ARN from your primary Region stack).</li>
<li>
<p>Select <strong>Submit</strong>.</p>
<p>Youll see a notification confirming that the configuration has succeeded.</p>
</li>
</ol>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>You can start the ingestion right away by selecting <strong>Start now</strong>.</p>
</div>
<h2 id="use">Use<a class="headerlink" href="#use" title="Permanent link"></a></h2>
<p>Once the integration is configured, you can trigger an AWS data ingestion.</p>
<h3 id="start-an-ingestion">Start an ingestion<a class="headerlink" href="#start-an-ingestion" title="Permanent link"></a></h3>
<p>To start an ingestion:</p>
<ol>
<li>Log in to AQtive Guard and select <strong>Data sources</strong> from the main menu.</li>
<li>Select <strong>Details</strong> in the <em>AWS</em> panel.</li>
<li>
<p>Select <strong>Start now</strong>.</p>
<p>Youll see a notification confirming that the ingestion has started.</p>
</li>
</ol>
<p>During an ingestion, AQtive Guard automatically:</p>
<ul>
<li>Crawls AWS regions to discover cryptographic assets.</li>
<li>Ingests data on certificates from AWS Certificate Manager (ACM), keys from AWS Key Management Service (KMS), and secrets from both AWS Secrets Manager and SSM Parameter Store.</li>
<li>Populates the <a href="../../inventory/">Inventory</a> with the identified objects, listed with a source of <em>AWS</em>.</li>
<li>Monitors CloudTrail for updates to maintain the inventory.</li>
</ul>
<h3 id="edit-a-connected-aws-account">Edit a connected AWS account<a class="headerlink" href="#edit-a-connected-aws-account" title="Permanent link"></a></h3>
<p>To edit a connected AWS account:</p>
<ol>
<li>Log in to AQtive Guard and select <strong>Data sources</strong> from the main menu.</li>
<li>Select <strong>Details</strong> in the <em>AWS</em> panel.</li>
<li>Select <strong>Edit</strong> to make any changes you need, then <strong>Submit</strong>.</li>
</ol>
<h2 id="unlink-the-aws-integration">Unlink the AWS integration<a class="headerlink" href="#unlink-the-aws-integration" title="Permanent link"></a></h2>
<p>Unlink the AWS integration only if your organization needs to reconfigure or stop data sharing with AWS.</p>
<p>To unlink the AWS configuration:</p>
<ol>
<li>Select <strong>Data sources</strong> from the main menu, then select <strong>Details</strong> in the <em>AWS</em> panel.</li>
<li>Select <strong>Edit</strong>, then <strong>Unlink</strong>.</li>
<li>Select <strong>Confirm and unlink Amazon Web Services</strong>.</li>
</ol>
<h2 id="troubleshooting">Troubleshooting<a class="headerlink" href="#troubleshooting" title="Permanent link"></a></h2>
<p>If your events arent reaching their destination, follow the troubleshooting steps that correspond to your deployment method:</p>
<ul>
<li><strong><a href="#aqtive-guard-cloudformation-template">AQtive Guard CloudFormation Template</a></strong> troubleshooting</li>
<li><strong><a href="#aws-stacksets-troubleshooting">AWS StackSets troubleshooting</a></strong></li>
<li><strong><a href="#custom-setup">Custom setup</a></strong> troubleshooting</li>
</ul>
<p>The sections below outline the troubleshooting steps for each method.</p>
<h3 id="aqtive-guard-cloudformation-template">AQtive Guard CloudFormation template<a class="headerlink" href="#aqtive-guard-cloudformation-template" title="Permanent link"></a></h3>
<p>If you used the AQtive Guard CloudFormation template, the following specific naming conventions and configurations are required for the integration to succeed.</p>
<h4 id="verify-eventbridge-rule">Verify EventBridge rule<a class="headerlink" href="#verify-eventbridge-rule" title="Permanent link"></a></h4>
<p>To verify that the EventBridge rule is set up correctly:</p>
<ol>
<li>Log in to your AWS console.</li>
<li>Navigate to <strong>Amazon EventBridge</strong>, then select <strong>Rules</strong> in the menu on the left.</li>
<li>Under <em>Event pattern rules</em>, locate the rule named <code>AQtiveGuardFilteredEventsRule</code>.</li>
<li>Ensure that the <em>Status</em> column shows <strong>Enabled (with CloudTrail read-only Management events)</strong>.</li>
</ol>
<h4 id="verify-rule-target">Verify rule target<a class="headerlink" href="#verify-rule-target" title="Permanent link"></a></h4>
<p>To verify that the rule target is set up correctly in AWS:</p>
<ol>
<li>Log in to your AWS console.</li>
<li>Navigate to <strong>Amazon EventBridge</strong>, then select <strong>Rules</strong> in the menu on the left.</li>
<li>Under <em>Event pattern rules</em>, locate the rule named <code>AQtiveGuardFilteredEventsRule</code> and select it.</li>
<li>On the <em>Rule details</em> page, select the <strong>Targets</strong> tab. </li>
<li>Look for the API destination named <code>AQGAWSDestinationApiRoute</code> and select it.</li>
<li>Under the <em>API destination details</em>, ensure that the status is <strong>Active</strong>.</li>
</ol>
<h4 id="check-connection-authorization">Check connection authorization<a class="headerlink" href="#check-connection-authorization" title="Permanent link"></a></h4>
<p>To verify that your connection is authorized:</p>
<ol>
<li>Log in to your AWS console.</li>
<li>Navigate to <strong>Amazon EventBridge</strong>, then select <strong>Connections</strong> in the menu on the left.</li>
<li>Locate the connection named <code>AQGAWSConnectionKey</code> and select it.</li>
<li>Under the <em>Connection details</em>, ensure that the status is <strong>Authorized</strong>. </li>
</ol>
<p>If the status is <strong>Deauthorized</strong>, youll need to <a href="#re-authenticate-the-connection">re-authenticate</a> the connection.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Connections can become deauthorized for several reasons, such as credential expiration or manual revocation. For a full list of scenarios, refer to the <a href="https://docs.aws.amazon.com/eventbridge/latest/userguide/eb-target-connection-deauthorize.html" rel="noopener" target="_blank">AWS documentation</a>.</p>
</div>
<p>If your rule is enabled, your destination is active, and your connection is authorized but events are still not flowing, please contact us through our <a href="https://support.sandboxaq.com/" rel="noopener" target="_blank">support portal</a>.</p>
<h3 id="aws-stacksets-troubleshooting">AWS StackSets troubleshooting<a class="headerlink" href="#aws-stacksets-troubleshooting" title="Permanent link"></a></h3>
<p>Because StackSet outcomes vary based on your specific deployment preferences (such as failure tolerance and region order), progress should be monitored directly through the AWS Console. You can track the real-time status of each region and account under the <em>Operations</em> and <em>Stack instances</em> tabs.</p>
<ul>
<li><strong>Primary region check</strong>: Ensure the region you designated as <code>PrimaryRegion</code> in the parameters was actually selected in the <em>Regions</em> deployment step. If the primary region stack fails, regional forwarders will have no destination.</li>
<li><strong>Stack instances</strong>: Check the <strong>Stack instances</strong> tab in your StackSet. If an individual region shows <code>OUTDATED</code> or <code>FAILED</code>, drill down into that specific stacks events to see the error.</li>
<li><strong>Permissions check</strong>: Verify that your <em>Administration</em> role has an inline policy allowing it to <code>sts:AssumeRole</code> the Execution role.</li>
</ul>
<h3 id="custom-setup">Custom setup<a class="headerlink" href="#custom-setup" title="Permanent link"></a></h3>
<p>If you manually configured your EventBridge resources, verify the status and configuration of your custom components.</p>
<h4 id="verify-rule-state">Verify rule state<a class="headerlink" href="#verify-rule-state" title="Permanent link"></a></h4>
<p>To verify that your custom rule is set up correctly:</p>
<ol>
<li>Log in to your AWS console.</li>
<li>Navigate to <strong>Amazon EventBridge</strong>, then select <strong>Rules</strong> in the menu on the left.</li>
<li>Under <em>Event pattern rules</em>, locate your custom rule.</li>
<li>Ensure that your rule is <strong>Enabled</strong>. A disabled rule will not process any incoming event patterns.</li>
</ol>
<h4 id="verify-rule-target_1">Verify rule target<a class="headerlink" href="#verify-rule-target_1" title="Permanent link"></a></h4>
<ol>
<li>Log in to your AWS console.</li>
<li>Navigate to <strong>Amazon EventBridge</strong>, then select <strong>Rules</strong> in the menu on the left.</li>
<li>Under <em>Event pattern rules</em>, locate your custom rule and select it.</li>
<li>On the <em>Rule details</em> page, select the <strong>Targets</strong> tab. </li>
<li>Look for your custom API destination and select it.</li>
<li>Under the <em>API destination details</em>, ensure that the status is <strong>Active</strong>.</li>
</ol>
<h4 id="check-connection-authorization_1">Check connection authorization<a class="headerlink" href="#check-connection-authorization_1" title="Permanent link"></a></h4>
<p>To verify that your connection is authorized:</p>
<ol>
<li>Log in to your AWS console.</li>
<li>Navigate to <strong>Amazon EventBridge</strong>, then select <strong>Connections</strong> in the menu on the left.</li>
<li>Locate your manually created connection attached to your custom rule and select it.</li>
<li>Under the <em>Connection details</em>, ensure that the status is <strong>Authorized</strong>. </li>
</ol>
<p>If the status is <strong>Deauthorized</strong>, youll need to <a href="#re-authenticate-the-connection">re-authenticate</a> the connection.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Connections can become deauthorized for several reasons, such as credential expiration or manual revocation. For a full list of scenarios, refer to the <a href="https://docs.aws.amazon.com/eventbridge/latest/userguide/eb-target-connection-deauthorize.html" rel="noopener" target="_blank">AWS documentation</a>.</p>
</div>
<h3 id="re-authenticate-the-connection">Re-authenticate the connection<a class="headerlink" href="#re-authenticate-the-connection" title="Permanent link"></a></h3>
<p>Connections can become deauthorized for several reasons, such as credential expiration or manual revocation. If your connection status is <strong>Deauthorized</strong>, follow these steps to restore the integration.</p>
<ol>
<li>From the <em>Connection Details</em>, select <strong>Edit</strong> to edit the connection.</li>
<li>In the <em>Configure authorization</em> section, select <strong>API key</strong>.</li>
<li>In the <strong>API key name</strong> field, enter <code>X-API-Key</code>.</li>
<li>In the <strong>Value</strong> field, enter your AQG API token. For details on retrieving or generating an AQG token, refer to <a href="../../settings/#create-an-api-token">Create an API token</a>.</li>
<li>Select <strong>Update</strong> and confirm that the <em>Connection details</em> page now shows a status of <strong>Authorized</strong>.</li>
</ol>
<p>If your rule is enabled, your destination is active, and your connection is authorized but events are still not flowing, please contact us through our <a href="https://support.sandboxaq.com/" rel="noopener" target="_blank">support portal</a>.</p>
</article>
</div>
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
<div class="md-copyright__highlight">
       2026 <a href="https://www.sandboxaq.com">SandboxAQ</a> | <a href="https://www.sandboxaq.com/legal/privacy-policy">Privacy Policy</a> | <a href="https://www.sandboxaq.com/legal/terms-conditions">Terms</a>
</div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tracking", "navigation.indexes", "content.code.copy"], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
<script src="../../assets/javascripts/bundle.ad660dcc.min.js"></script>
<script src="../../gen/main.js"></script>
<script src="../../javascripts/mathjax.js"></script>
<script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
<script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script><script>document$.subscribe(() => {
            window.update_swagger_ui_iframe_height = function (id) {
                var iFrameID = document.getElementById(id);
                if (iFrameID) {
                    full_height = (iFrameID.contentWindow.document.body.scrollHeight + 80) + "px";
                    iFrameID.height = full_height;
                    iFrameID.style.height = full_height;
                }
            }
        
            let iframe_id_list = []
            var iframes = document.getElementsByClassName("swagger-ui-iframe");
            for (var i = 0; i < iframes.length; i++) { 
                iframe_id_list.push(iframes[i].getAttribute("id"))
            }
        
            let ticking = true;
            
            document.addEventListener('scroll', function(e) {
                if (!ticking) {
                    window.requestAnimationFrame(()=> {
                        let half_vh = window.innerHeight/2;
                        for(var i = 0; i < iframe_id_list.length; i++) {
                            let element = document.getElementById(iframe_id_list[i])
                            if(element==null){
                                return
                            }
                            let diff = element.getBoundingClientRect().top
                            if(element.contentWindow.update_top_val){
                                element.contentWindow.update_top_val(half_vh - diff)
                            }
                        }
                        ticking = false;
                    });
                    ticking = true;
                }
            });
        
            const dark_scheme_name = "slate"
            
            window.scheme = document.body.getAttribute("data-md-color-scheme")
            const options = {
                attributeFilter: ['data-md-color-scheme'],
            };
            function color_scheme_callback(mutations) {
                for (let mutation of mutations) {
                    if (mutation.attributeName === "data-md-color-scheme") {
                        scheme = document.body.getAttribute("data-md-color-scheme")
                        var iframe_list = document.getElementsByClassName("swagger-ui-iframe")
                        for(var i = 0; i < iframe_list.length; i++) {
                            var ele = iframe_list.item(i);
                            if (ele) {
                                if (scheme === dark_scheme_name) {
                                    ele.contentWindow.enable_dark_mode();
                                } else {
                                    ele.contentWindow.disable_dark_mode();
                                }
                            }
                        }
                    }
                }
            }
            observer = new MutationObserver(color_scheme_callback);
            observer.observe(document.body, options);
            })</script></body>
</html>